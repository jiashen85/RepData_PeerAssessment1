# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data


```r
dat<-read.csv("./activity.csv")
library(dplyr)
```

```
## 
## Attaching package: 'dplyr'
## 
## The following object is masked from 'package:stats':
## 
##     filter
## 
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
```


## What is mean total number of steps taken per day?


```r
#according to the project requirement, we can ignore the missing values. therefore, na.action=na.omit is used to removed NAs. 
new<-aggregate(steps~date,data=dat,sum,na.action=na.omit)

hist(new$steps,xlab="steps",ylab="days",main="Histogram of Total Number of Steps Per Day",breaks=10)
```

![](PA1_template_files/figure-html/unnamed-chunk-2-1.png) 


```r
mean<-mean(new$steps);mean
```

[1] 10766.19

```r
median<-median(new$steps);median
```

[1] 10765


## What is the average daily activity pattern?


```r
#Create a new data set that groups the means of the steps taken aross all days by interval without considering the missing values. 
new1<-aggregate(steps~interval,data=dat,match.fun(mean),na.action=na.omit)
#find the max mean position and extract the interval value based on that. 
mx<-which(new1$steps==max(new1$steps,na.rm=T));mx
```

```
## [1] 104
```

```r
max_interval<-new1$interval[mx];max_interval
```

```
## [1] 835
```

```r
#We found the max_interval is 8:35 and on the 104th interval. 

#To make a time series plot of average daily activity pattern between steps taken and 5-minute interval.

#After observation, we know there is 60*24/5=288 intervals during a day and interval "100" is right after interval value "55". This causes a  "chain-saw" looking trend line appear. Therefore, it is devised to convert the intervals to factors and present 288 of them on the x-axis to avoid the "saw" look.

new1$interval<-as.factor(new1$interval)
plot(x=as.numeric(new1$interval),y=new1$steps,xlab="5-minute interval", ylab="average number of steps taken", main="Average Daily Activity Pattern", type="l")

#the interval that has the maximum steps is the 104th interval which is 8:35 am marked by the red line.

abline(v=mx, col="red")
text(x=104,y=0,labels="8:35")
```

![](PA1_template_files/figure-html/unnamed-chunk-4-1.png) 

Therefore, the interval has the maximum number of steps are "835" meaning "8:35 am".This finding reflects that the user is most active at 8:35 am during a day.  

## Imputing missing values


```r
#below is the total number of missing values in the dataset:

sum<-sum(is.na(dat$steps));sum
```

[1] 2304


```r
#create a new data set new2 to group means of the steps by interval.
new2<-aggregate(steps~interval,data=dat,match.fun(mean))

#new2 is then merged with the original data set "dat" by the key "interval" and its columns are renamed for the future use.

new3<-merge (new2,dat, by="interval")
names(new3)<-c("interval","meansteps","steps","date")

#replace all the NAs with the correspondent mean value of the steps by each interval.

new3$steps[is.na(new3$steps)]<-new3$meansteps[is.na(new3$steps)]

#to create a equivalent data set"new4" to the original data set by cutting the unwanted "meansteps" column. 
new4<-subset(new3,select=-meansteps)
```


```r
#to group the total number of steps again with all the misssing values filled in.
new5<-aggregate(steps~date,data=new4,match.fun(sum))

#to make a histogram over steps.
hist(new5$steps,xlab="steps",ylab="days",main="Histogram of Total Number of Steps Per Day",breaks=10)
```

![](PA1_template_files/figure-html/unnamed-chunk-7-1.png) 

```r
#to calculate the new mean and median after imputing.
mean2<-mean(new5$steps);mean2
```

[1] 10766.19

```r
median2<-median(new5$steps);median2
```

[1] 10766.19

From above, we didn't see much of difference from the estimates of first part assignment. They have the same mean. The impact of imputing missing data on the estimates of the total daily number of steps are not that compelling.

Generally speaking, imputing missing values can reduce bias and increase the representativeness of the results.However, using different strategies could lead to different effects. In our case, we used mean to substitue the original missing values, although simple, it's not that effective to increase the representativeness. This is because,in practice, the missing values could be simply generated by people who were not that active at those intervals or not tracking due to dead battery. Therefore, imputing with mean values could only pull the mean towards the orginal mean and deviate the current median towards the current mean as we do have more mean-value observations now.

## Are there differences in activity patterns between weekdays and weekends?


```r
#using weekday() function to convert all the days to the exact weekdays or weekends and add one new column.
new4$date<-as.POSIXlt(new4$date)
new4$weekdays<-weekdays(new4$date,abbreviate=T)

#to convert all the weekdays and weekend days to two level factors "weekday" and "weekend".

new4$weekdays[new4$weekdays %in% c("Sun", "Sat")]<-"weekend"
new4$weekdays[new4$weekdays %in% c("Mon", "Tue","Wed","Thu","Fri")]<-"weekday"
#converting character value to factors.
new4$weekdays<-as.factor(new4$weekdays)

#the reason date column has been converted to character vector is because when running filter function below, there is error messge saying "column 'date' has unsupported type : POSIXlt, POSIXt".
new4$date<-as.character(new4$date)

#subsetting the data set whose missing values are filled up into weekend and weekday sets.
weekend<-filter(new4,new4$weekdays=="weekend")
weekday<-filter(new4,new4$weekdays=="weekday")

#aggregate each data set the mean of steps by interval and add one more column of weekday.
weekend_it<-aggregate(steps~interval,data=weekend,match.fun(mean))
weekend_it$weekday<-"weekend"
weekday_it<-aggregate(steps~interval,data=weekday,match.fun(mean))
weekday_it$weekday<-"weekday"

#merge the two processed datasets together and make the weekday variable a factor varaible for plotting convenience. 
merged<-rbind(weekend_it,weekday_it)
merged$weekday<-as.factor(merged$weekday)


#using ggplot2 plotting system to get a 2 row *1 column panel plot to showcase the difference between weekday and weekend steps. 
library(ggplot2)
#intervals are converted to factors to avoid the "saw" look graphic which doesn't truely reflect the nature of the intervals. 

merged$interval<-as.factor(merged$interval)
qplot(x=as.numeric(interval),y=steps,data=merged,facets=weekday~.,geom="line",xlab="Interval",ylab="Number of steps")
```

![](PA1_template_files/figure-html/unnamed-chunk-8-1.png) 


